import{f as G,b as u,H as R,o as h,c as M,w as t,a as e,N as V,u as l,s as L,y as F,F as U,i as P,O as X,x as K,_ as H,P as ee,k as S,J as te,l as I,m as se,I as oe,K as le,v as k,Q as T,R as ne,S as ae,G as D,j as re,D as ce}from"./js/index-DmSYC_uc.js";import{_ as Q}from"./index.RWQKoqDA.js";import{u as Y,m as E}from"./setting.DlWchkEa.js";import"./index.Cey-yjDg.js";const ue=G({__name:"index",props:{width:{default:670},prizesList:{}},emits:["change"],setup(N,{expose:b,emit:g}){const c=Object.freeze(360),o=Object.freeze(24),m=Object.freeze(8),x=Object.freeze(5e3),$=u([]),f=u(!1),z=u(5),d=u(null),C=N,s=g,a=R(()=>({width:`${C.width}rpx`,height:`${C.width}rpx`})),r=R(()=>d.value?{transform:`rotate(${d.value}deg)`,transition:`transform ${x}ms ease-in-out`}:{}),v=R(()=>{$.value=[],d.value=null;const w=C.prizesList,n=w.length,i=c/n,_=i/2,y=+(n==2?"50":"0"),j=n<=3?"100":"50",Z=n==3?"-50":"0",q=n<=2?0:-(n-4)*90/n;return w.forEach((O,A)=>{const J=-(A*i+_),W=n>2?A*360/n:"0";O.prize={transform:`rotate(${-J}deg)`,width:`${100/n*2}%`,marginLeft:`-${100/n}%`,fontSize:`${o-n}px`},O.whelm={transform:`rotate(${W}deg) skewY(${q}deg)`,right:`${y*A}%`,height:`${j}%`,top:`${Z}%`,width:`${n==1?100:50}%`,background:O.color},$.value.push(J)}),w}),p=()=>{if(f.value)return!1;z.value=Math.floor(Math.random()*v.value.length),B()},B=()=>{f.value=!0,d.value=(d.value??0)+m*c+$.value[z.value]-(d.value??0)%c,setTimeout(()=>{f.value=!1,s("change",v.value[z.value].name)},x+500)};return b({isRotating:f}),(w,n)=>{const i=P;return h(),M(i,{style:V(l(a)),class:"turntable"},{default:t(()=>[e(i,{class:"turntable-box"},{default:t(()=>[e(i,{style:V([l(r)]),class:"whelm"},{default:t(()=>[(h(!0),L(U,null,F(l(v),_=>(h(),L("div",{key:_.index,style:V([_.whelm]),class:"whelm-item"},null,4))),128))]),_:1},8,["style"]),e(i,{class:"prize"},{default:t(()=>[e(i,{style:V([l(r)]),class:"prize-list"},{default:t(()=>[(h(!0),L(U,null,F(l(v),_=>(h(),L("div",{key:_.index,style:V([_.prize]),class:"prize-list-item"},[X("div",null,K(_.name),1)],4))),128))]),_:1},8,["style"]),e(i,{class:"prize-point",onClick:p})]),_:1})]),_:1})]),_:1},8,["style"])}}}),ie=H(ue,[["__scopeId","data-v-4a307455"]]),_e=G({__name:"addPopup",setup(N,{expose:b}){const{prizeInfo:g}=Y(),c=u(!1),o=u({}),m=u(0);ee(()=>c.value,s=>{s&&(o.value={},x())});const x=()=>{for(const s in D(g.list))o.value[`${s}_name`]=D(g.list)[s]},$=()=>{c.value=!0},f=s=>Number(s.split("_")[0])+1,z=()=>{const s=Object.keys(o.value).length;o.value[`${s}_name`]="",ne(()=>{m.value+=500})},d=s=>{delete o.value[s]},C=()=>{g.list=Object.values(o.value)};return b({openSetting:$}),(s,a)=>{const r=S(I("u-input"),te),v=S(I("u-icon"),se),p=S(I("u-form-item"),oe),B=S(I("u-form"),le),w=P,n=ae,i=S(I("s-popup"),Q);return h(),M(i,{show:l(c),"onUpdate:show":a[0]||(a[0]=_=>T(c)?c.value=_:null),"mask-close-able":!1,"show-close":!0,title:"设置菜单",width:"85%","z-index":"100000",onCommit:C},{default:t(()=>[e(n,{"scroll-top":l(m),class:"popup","scroll-y":"true"},{default:t(()=>[e(w,{class:"form"},{default:t(()=>[e(B,{ref:"uForm",model:l(o)},{default:t(()=>[(h(!0),L(U,null,F(l(o),(_,y)=>(h(),M(p,{key:y,label:`位置${f(y)}`,class:"u-border-bottom","label-width":"80"},{right:t(()=>[e(v,{name:"trash-fill",onClick:j=>d(y)},null,8,["onClick"])]),default:t(()=>[e(r,{modelValue:l(o)[`${y}`],"onUpdate:modelValue":j=>l(o)[`${y}`]=j,placeholder:`请输入位置${f(y)}`,border:"none",maxlength:"10",type:"select"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]))),128))]),_:1},8,["model"])]),_:1})]),_:1},8,["scroll-top"]),e(w,{class:"add u-border-top"},{default:t(()=>[e(w,{class:"add-btn",onClick:z},{default:t(()=>[k("加一项鸭")]),_:1})]),_:1})]),_:1},8,["show"])}}}),de=H(_e,[["__scopeId","data-v-547663aa"]]),pe=G({__name:"index",setup(N){const{prizeInfo:b}=Y(),g=u(null),c=u(null),o=u(!1),m=u(!1),x=u(""),$=R(()=>{var s;return(s=g.value)==null?void 0:s.isRotating});re(()=>({title:"牛马工具"}));const f=R(()=>b.list.map((s,a)=>({name:s,index:a}))),z=()=>{b.list=D(E).splice(0,8)},d=()=>{b.list=Array.from({length:8},(s,a)=>a).map(()=>E[Math.floor(Math.random()*E.length)])},C=s=>{x.value=s,m.value=!0};return(s,a)=>{const r=P,v=S(I("s-popup"),Q);return h(),M(r,{class:"lottery"},{default:t(()=>[e(r,{class:"lottery-hint"},{default:t(()=>[k("当不知道吃什么的时候，可以写下附近喜欢吃的小店，开启随机转一转，不为吃饭而烦恼。")]),_:1}),e(ie,{ref_key:"turntable",ref:g,"prizes-list":l(f),onChange:C},null,8,["prizes-list"]),e(r,{class:ce([{pointer:l($)},"lottery-btn"])},{default:t(()=>{var p;return[e(r,{class:"lottery-btn-setting",onClick:(p=l(c))==null?void 0:p.openSetting},{default:t(()=>[k("我的菜单")]),_:1},8,["onClick"]),e(r,{class:"lottery-btn-setting",onClick:d},{default:t(()=>[k("随机菜单")]),_:1}),e(r,{class:"lottery-btn-setting",onClick:a[0]||(a[0]=B=>o.value=!0)},{default:t(()=>[k("重置")]),_:1})]}),_:1},8,["class"]),e(v,{show:l(o),"onUpdate:show":a[1]||(a[1]=p=>T(o)?o.value=p:null),"show-close":!0,title:"确认重置",width:"80%",onCommit:z},{default:t(()=>[e(r,{class:"toast"},{default:t(()=>[e(r,{class:"toast-title"},{default:t(()=>[k("重置后，你所保留的内容会消失！")]),_:1})]),_:1})]),_:1},8,["show"]),e(v,{show:l(m),"onUpdate:show":a[2]||(a[2]=p=>T(m)?m.value=p:null),title:"今天去吃",width:"80%"},{default:t(()=>[e(r,{class:"toast"},{default:t(()=>[e(r,{class:"toast-lottery"},{default:t(()=>[k(K(l(x)),1)]),_:1})]),_:1})]),_:1},8,["show"]),e(de,{ref_key:"addRef",ref:c},null,512)]),_:1})}}}),ge=H(pe,[["__scopeId","data-v-cc4c0925"]]);export{ge as default};
